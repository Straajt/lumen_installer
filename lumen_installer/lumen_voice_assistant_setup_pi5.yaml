
# ğŸ§  Lumen Voice Assistant Setup (Home Assistant OS + Raspberry Pi 5)

Dies ist eine vollstÃ¤ndige Anleitung, um **Lumen** als Voice Assistant mit **Wake Word**, **lokalem Intent Matching** und **ChatGPT-Integration** auf deinem Raspberry Pi 5 unter **Home Assistant OS** einzurichten â€“ komplett ohne neue Hardware.

---

## âœ… Voraussetzungen
- Home Assistant OS auf Raspberry Pi 5
- HACS installiert
- Media Player zur Audioausgabe (z.â€¯B. `media_player.arc`)
- Mikrofon Ã¼ber USB oder 3,5mm-Klinke (Plug & Play)

---

## ğŸ” ArchitekturÃ¼berblick

1. ğŸ—£ï¸ Du sagst: **â€Hey Lumen, mach das Licht anâ€œ**
2. ğŸ§  `OpenWakeWord` erkennt das Wake Word lokal
3. ğŸ§ `Whisper` oder `Google STT` wandelt Sprache zu Text um
4. ğŸ’¡ Lokale Intent-Analyse Ã¼ber Home Assistant Assist
5. ğŸ¤– Optional: Weiterleitung zu ChatGPT fÃ¼r generative Antworten
6. ğŸ”Š TTS Ã¼ber `tts.cloud_say`, `piper`, oder `polly` zurÃ¼ck

---

## ğŸ“¦ Schritt-fÃ¼r-Schritt Installation

### 1. ğŸ”Š Mikrofon testen (Add-on: Audio-Recorder)

- Installiere Add-on: `Audio Recorder` Ã¼ber Supervisor
- Teste, ob Sprache erkannt wird

---

### 2. ğŸ“¦ OpenWakeWord + Whisper installieren (lokal)

â¡ï¸ In Home Assistant: **Einstellungen > Sprachassistent > Pipelines**

- **Wake Word aktivieren**
  - WÃ¤hle â€Wyoming OpenWakeWordâ€œ
  - Wake Word: `Hey Lumen` (custom oder Standard wie â€Jarvisâ€œ)

- **STT aktivieren**
  - WÃ¤hle z.â€¯B. `Whisper` (lokal) oder `Google Speech-to-Text` (schneller)

- **TTS aktivieren**
  - Z.â€¯B. `tts.cloud_say`, `piper`, `amazon_polly`

---

### 3. ğŸ¯ Lokale Intents definieren

â¡ï¸ `configuration.yaml`:

```yaml
intent_script:
  LichtAn:
    action:
      - service: light.turn_on
        target:
          entity_id: light.livingroom_light
  LichtAus:
    action:
      - service: light.turn_off
        target:
          entity_id: light.livingroom_light
```

â¡ï¸ Dann `intents.yaml`:

```yaml
- name: LichtAn
  sentences:
    - mach das licht an
    - licht einschalten
    - lumen, ich brauche licht
- name: LichtAus
  sentences:
    - licht aus
    - mach das licht aus
```

---

### 4. ğŸ§  ChatGPT-Integration (optional)

â¡ï¸ Nutze REST-Command oder `OpenAI`-Integration via Custom Script:

```yaml
rest_command:
  lumen_chat:
    url: "https://api.openai.com/v1/chat/completions"
    method: POST
    headers:
      Authorization: "Bearer YOUR_API_KEY"
      Content-Type: "application/json"
    payload: >
      {
        "model": "gpt-4",
        "messages": [{"role": "user", "content": "{{ prompt }}"}]
      }
```

â¡ï¸ Danach per Skript in `scripts.yaml` nutzbar mit TTS-Antwort

---

### 5. ğŸ—£ï¸ Test: Wake Word & Sprache

- Sag â€Hey Lumenâ€œ
- Stelle Frage oder Befehl
- Home Assistant erkennt Intent oder leitet an Lumen (ChatGPT) weiter
- Antwort kommt Ã¼ber `media_player.arc` zurÃ¼ck

---

## ğŸ Bonus: Dashboard-Schalter fÃ¼r Sprachmodus

```yaml
type: button
name: Sprachmodus aktiv
tap_action:
  action: call-service
  service: assist_pipeline.start
```

---

## ğŸ“Œ Tipps

- Mikro-Nutzung optimieren mit `usb_audio_fix` Add-on (fÃ¼r Pi)
- Pipelines kÃ¶nnen zwischen lokalem und cloudbasiertem Modus wechseln
- Nutze `debug`-Modus unter "Sprachassistent", um alles zu testen

---

Fragen? Anpassen? Dein Lumen ist bereit! ğŸ˜
